# SPDX-FileCopyrightText: 2025 Juan Manuel MÃ©ndez Rey
# SPDX-License-Identifier: GPL-3.0-or-later

# Additional security configuration
# This file can be included in both local and production configs

# Block known bad user agents and suspicious patterns
<Directory />
    SetEnvIfNoCase User-Agent "^(libwww|wget|python|perl|curl|PHP)" bad_bot
    SetEnvIfNoCase User-Agent "(bot|crawler|spider)" bad_bot

    # Allow legitimate browsers and game clients
    SetEnvIfNoCase User-Agent "(firefox|chrome|safari|edge|opera)" good_browser

    # Block requests with no user agent
    SetEnvIf User-Agent "^$" bad_bot

    # Log bad bot attempts
    SetEnvIf bad_bot "1" log_bad_bot

    # Basic bot blocking (less strict than mod_evasive but still effective)
    <RequireAll>
        Require all granted
        Require not env bad_bot
    </RequireAll>
</Directory>

# Prevent access to sensitive files
<Files ~ "^\.(htaccess|htpasswd|git|env|log)">
    Require all denied
</Files>

# Block suspicious request patterns
<LocationMatch "/(\.git|\.env|config|admin|phpmyadmin)">
    Require all denied
</LocationMatch>

# Limit request size (prevent large uploads)
LimitRequestBody 1048576

# Timeout settings
Timeout 60
KeepAliveTimeout 5

# Additional security headers for all responses
Header always set X-Robots-Tag "noindex, nofollow"
Header always unset X-Powered-By
Header always unset Server